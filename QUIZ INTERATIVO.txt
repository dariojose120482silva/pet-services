	QUIZ INTERATIVO:



<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Quiz Din√¢mico (Vers√£o Segura)</title>
    <!-- Inclui Tailwind CSS para estiliza√ß√£o r√°pida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .lds-dual-ring {
            display: inline-block;
            width: 20px;
            height: 20px;
        }
        .lds-dual-ring:after {
            content: " ";
            display: block;
            width: 16px;
            height: 16px;
            margin: 1px;
            border-radius: 50%;
            border: 3px solid #fff;
            border-color: #fff transparent #fff transparent;
            animation: lds-dual-ring 1.2s linear infinite;
        }
        @keyframes lds-dual-ring {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 sm:p-8 flex justify-center items-center min-h-screen">

    <div id="main-content" class="w-full max-w-lg bg-white rounded-xl shadow-2xl p-6 sm:p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">
            üß† Gerador de Quiz Din√¢mico (Seguro)
        </h1>
        
        <div class="mb-6 pb-4 border-b border-gray-200">
            <p id="api-status-msg" class="text-xs text-amber-600 mb-2 font-semibold">
                ‚ö†Ô∏è Verificando conex√£o com o backend...
            </p>
            <label for="quiz-prompt" class="block text-sm font-medium text-gray-700 mb-2">
                Qual exerc√≠cio voc√™ quer criar? (Assunto + Quantidade)
            </label>
            <textarea id="quiz-prompt" 
                      rows="2"
                      class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-700"
                      placeholder="Ex: Gere 5 perguntas sobre JavaScript."></textarea>
            
            <button id="generate-quiz-button" 
                    class="mt-3 w-full py-3 px-6 bg-purple-600 text-white font-semibold rounded-lg shadow-md hover:bg-purple-700 transition duration-300 flex items-center justify-center disabled:opacity-50">
                Gerar Novo Quiz
            </button>
            
            <div id="loading-indicator" class="hidden mt-3 text-center text-sm text-gray-500">
                <div class="lds-dual-ring inline-block align-middle mr-2"></div> Gerando perguntas...
            </div>
             <p id="error-message" class="hidden text-sm text-red-500 mt-2"></p>
        </div>

        <div id="quiz-area" class="hidden">
            <p id="question-text" class="text-xl font-semibold mb-6 text-gray-700"></p>
            <div id="options-container" class="space-y-4"></div>
            <div class="mt-8 pt-6 border-t border-gray-200">
                <div id="feedback-message" class="text-center font-bold text-lg mb-4 h-6"></div>
                <div class="flex justify-between space-x-4">
                    <button id="next-button" 
                            class="w-full py-3 px-6 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-300 disabled:opacity-50"
                            disabled>
                        Pr√≥xima Pergunta
                    </button>
                </div>
                <p id="progress-text" class="text-sm text-gray-500 mt-4 text-center"></p>
            </div>
        </div>
        <p id="initial-message" class="text-center text-gray-500 mt-6">
            Digite o seu pedido e clique em "Gerar Novo Quiz"!
        </p>

    </div>

    <div id="results-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-xl p-8 max-w-sm w-full text-center">
            <h2 class="text-2xl font-bold text-green-600 mb-4">Quiz Conclu√≠do! üéâ</h2>
            <p id="score-text" class="text-xl text-gray-700 mb-6"></p>
            <button id="restart-generator-button" 
                    class="w-full py-3 px-6 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition duration-300">
                Gerar Outro Quiz
            </button>
        </div>
    </div>

    <script>
        /**
         * CONFIGURA√á√ÉO DA URL DO BACKEND
         * Para funcionar no Vercel, o arquivo deve estar na mesma URL da API.
         * Se estiver rodando localmente ou em outro lugar, substitua a string abaixo
         * pela URL completa que o Vercel te deu.
         */
        let BACKEND_URL = "/api/generate-quiz"; 

        // Verifica√ß√£o amig√°vel para evitar o erro de URL inv√°lida
        if (window.location.hostname === "localhost" || window.location.hostname.includes("usercontent.goog")) {
             // Se estiver em ambiente de teste ou preview, avisamos o usu√°rio
             const statusMsg = document.getElementById('api-status-msg');
             statusMsg.textContent = "‚ÑπÔ∏è Nota: Para funcionar aqui, voc√™ precisa colocar a URL completa do seu projeto Vercel no c√≥digo.";
             statusMsg.classList.replace('text-green-600', 'text-amber-600');
        } else {
             document.getElementById('api-status-msg').textContent = "‚úÖ Backend configurado via Vercel.";
        }

        const quizPrompt = document.getElementById('quiz-prompt');
        const generateButton = document.getElementById('generate-quiz-button');
        const loadingIndicator = document.getElementById('loading-indicator');
        const errorMessage = document.getElementById('error-message');
        const quizArea = document.getElementById('quiz-area');
        const initialMessage = document.getElementById('initial-message');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const nextButton = document.getElementById('next-button');
        const feedbackMessage = document.getElementById('feedback-message');
        const progressText = document.getElementById('progress-text');
        const resultsModal = document.getElementById('results-modal');
        const scoreText = document.getElementById('score-text');
        const restartGeneratorButton = document.getElementById('restart-generator-button');

        let quizData = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let answered = false;

        async function generateQuizFromPrompt() {
            const prompt = quizPrompt.value.trim();
            if (!prompt) {
                errorMessage.textContent = 'Por favor, digite o t√≥pico do seu quiz.';
                errorMessage.classList.remove('hidden');
                return;
            }

            // Tratamento especial para evitar o erro de fetch que voc√™ recebeu
            if (BACKEND_URL.includes("[SEU-DOM√çNIO-VERCEL]")) {
                errorMessage.textContent = 'Erro de Configura√ß√£o: Voc√™ precisa substituir "[SEU-DOM√çNIO-VERCEL]" no c√≥digo pela sua URL real da Vercel.';
                errorMessage.classList.remove('hidden');
                return;
            }

            errorMessage.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');
            generateButton.disabled = true;

            try {
                const response = await fetch(BACKEND_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ quizPrompt: prompt })
                });

                if (!response.ok) {
                    const errorDetails = await response.json();
                    throw new Error(errorDetails.message || 'Erro no servidor.');
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];
                
                if (candidate && candidate.content?.parts?.[0]?.text) {
                    const jsonText = candidate.content.parts[0].text;
                    quizData = JSON.parse(jsonText);
                    startNewQuiz();
                } else {
                    throw new Error("Resposta do modelo inv√°lida.");
                }

            } catch (error) {
                console.error("Erro ao gerar quiz:", error);
                errorMessage.textContent = `Erro: ${error.message}. Verifique se a sua fun√ß√£o na Vercel est√° ativa e se a API KEY foi configurada.`;
                errorMessage.classList.remove('hidden');
            } finally {
                loadingIndicator.classList.add('hidden');
                generateButton.disabled = false;
            }
        }

        function startNewQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            quizArea.classList.remove('hidden');
            initialMessage.classList.add('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestionIndex >= quizData.length) {
                showResults();
                return;
            }

            answered = false;
            nextButton.disabled = true;
            feedbackMessage.textContent = '';
            optionsContainer.innerHTML = '';

            const currentQuestion = quizData[currentQuestionIndex];
            questionText.textContent = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;

            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'w-full text-left py-3 px-4 bg-gray-100 text-gray-800 rounded-lg hover:bg-blue-200 transition duration-200 font-medium shadow-sm';
                button.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(button);
            });

            updateProgress();
        }

        function selectAnswer(selectedIndex) {
            if (answered) return;
            answered = true;
            nextButton.disabled = false;
            
            const currentQuestion = quizData[currentQuestionIndex];
            const correctIndex = currentQuestion.answerIndex;
            const optionButtons = optionsContainer.children;

            Array.from(optionButtons).forEach((button, index) => {
                button.disabled = true;
                if (index === selectedIndex) {
                    if (index === correctIndex) {
                        button.classList.add('bg-green-500', 'text-white');
                        feedbackMessage.textContent = 'üéâ Correto!';
                        feedbackMessage.classList.add('text-green-600');
                        score++;
                    } else {
                        button.classList.add('bg-red-500', 'text-white');
                        feedbackMessage.textContent = '‚ùå Incorreto!';
                        feedbackMessage.classList.add('text-red-500');
                        optionButtons[correctIndex].classList.add('bg-green-300', 'text-green-900');
                    }
                }
            });

            const justificationP = document.createElement('p');
            justificationP.textContent = `üí° ${currentQuestion.justification}`;
            justificationP.className = 'mt-4 p-3 bg-blue-50 border-l-4 border-blue-500 text-sm text-gray-700 rounded-md';
            optionsContainer.appendChild(justificationP);
        }

        function updateProgress() {
            progressText.textContent = `Quest√£o ${currentQuestionIndex + 1} de ${quizData.length}`;
            nextButton.textContent = currentQuestionIndex === quizData.length - 1 ? 'Ver Resultados' : 'Pr√≥xima Pergunta';
        }

        function showResults() {
            scoreText.textContent = `Voc√™ acertou ${score} de ${quizData.length} quest√µes!`;
            resultsModal.classList.remove('hidden');
        }
        
        function restartGenerator() {
            resultsModal.classList.add('hidden');
            quizArea.classList.add('hidden');
            initialMessage.classList.remove('hidden');
            quizPrompt.value = '';
            quizData = [];
        }

        generateButton.addEventListener('click', generateQuizFromPrompt);
        nextButton.addEventListener('click', () => {
            currentQuestionIndex++;
            loadQuestion();
        });
        restartGeneratorButton.addEventListener('click', restartGenerator);
        
    </script>
</body>
</html>